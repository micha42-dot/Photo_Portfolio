<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Michael Förtsch | Fotografie</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600&family=Outfit:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Manrope', 'sans-serif'],
                        brand: ['Outfit', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react/": "https://esm.sh/react@^19.2.4/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-white text-gray-900 font-sans selection:bg-black selection:text-white flex flex-col min-h-screen">

    <!-- HEADER -->
    <header class="sticky top-0 z-40 bg-white/95 backdrop-blur-sm w-full border-b border-gray-100 transition-all duration-300">
        <div class="max-w-[1800px] mx-auto px-6 py-4 flex items-center justify-between">
            <div class="flex-shrink-0 z-50">
                <h1 onclick="filterImages('all')" class="text-lg md:text-xl font-bold tracking-[0.2em] uppercase text-black cursor-pointer hover:opacity-70 transition-opacity font-brand">
                    Michael Förtsch
                </h1>
            </div>
            
            <!-- Desktop Navigation -->
            <nav class="hidden md:block">
                <ul class="flex items-center gap-8" id="desktop-nav">
                    <!-- Wird per Javascript gefüllt -->
                </ul>
            </nav>

            <!-- Mobile Burger Button -->
            <button class="md:hidden z-50 p-2 -mr-2 text-black focus:outline-none" onclick="toggleMobileMenu()">
                <div class="w-5 flex flex-col items-end gap-[5px]">
                    <span id="burger-1" class="h-[2px] bg-black w-full transition-all duration-300"></span>
                    <span id="burger-2" class="h-[2px] bg-black w-full transition-all duration-300"></span>
                    <span id="burger-3" class="h-[2px] bg-black w-full transition-all duration-300"></span>
                </div>
            </button>
        </div>
    </header>

    <!-- MOBILE MENU OVERLAY -->
    <div id="mobile-menu" class="fixed inset-0 bg-white z-40 flex flex-col justify-center items-center opacity-0 pointer-events-none transition-all duration-500">
        <nav class="flex flex-col gap-8 text-center" id="mobile-nav-items"></nav>
    </div>

    <!-- MAIN GALLERY -->
    <main class="flex-grow w-full max-w-[1800px] mx-auto px-4 py-8">
        <div id="gallery-grid" class="columns-1 sm:columns-2 lg:columns-3 gap-4 space-y-4"></div>
        
        <!-- Fallback Meldung -->
        <div id="no-results" class="hidden flex justify-center items-center h-64 text-gray-400 font-light">
            Keine Bilder in dieser Kategorie gefunden.
        </div>
    </main>

    <!-- JOURNALISM SECTION (Gray Background) -->
    <section class="w-full bg-gray-50 py-16 mt-20">
        <div class="max-w-2xl mx-auto px-6 text-center">
            <h2 class="text-xl md:text-2xl font-bold tracking-wide mb-4 font-brand">JOURNALISMUS</h2>
            <p class="text-gray-500 text-sm mb-8 font-light max-w-lg mx-auto leading-relaxed">
                Neben der Fotografie arbeitet Michael Förtsch als Technologie- und Wissenschaftsjournalist. 
                Entdecken Sie seine Artikel, Essays und Reportagen.
            </p>
            
            <div>
                <a href="https://michaelfoertsch.de" target="_blank" rel="noopener noreferrer" class="inline-block bg-black text-white px-8 py-3 text-xs font-bold tracking-widest hover:bg-gray-800 transition-colors uppercase font-brand">
                    Zu michaelfoertsch.de
                </a>
            </div>
        </div>
    </section>

    <!-- FOOTER (White Background) -->
    <footer class="w-full bg-white py-12 border-t border-gray-100">
        <div class="max-w-2xl mx-auto px-6 text-center">
            <div class="text-gray-400 text-xs tracking-wider font-brand flex flex-col items-center gap-2">
                <p>© <span id="year"></span> MICHAEL FÖRTSCH. ALLE RECHTE VORBEHALTEN.</p>
                <a href="https://michaelfoertsch.de/impressum.html" target="_blank" rel="noopener noreferrer" class="hover:text-black transition-colors underline decoration-1 underline-offset-2">
                    IMPRESSUM
                </a>
            </div>
        </div>
    </footer>

    <!-- INFO / ÜBER OVERLAY -->
    <div id="info-overlay" class="fixed inset-0 z-50 flex items-center justify-center bg-white/95 backdrop-blur-md opacity-0 pointer-events-none transition-opacity duration-300">
        <button onclick="closeInfo()" class="absolute top-6 right-6 text-black hover:opacity-50 z-50 p-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
        </button>
        <div class="max-w-2xl px-6 text-center">
            <h2 class="text-3xl font-bold mb-6 font-brand tracking-widest uppercase">Michael Förtsch</h2>
            <p class="text-gray-600 leading-relaxed mb-8 font-light">
                Willkommen im Portfolio. Hier finden Sie eine Auswahl an fotografischen Arbeiten aus den Bereichen Landschaft, Urban und Portrait. 
                Die Bilder fangen Momente der Stille und der Bewegung im urbanen Raum und in der Natur ein.
            </p>
            <p class="text-sm text-gray-400 font-brand uppercase tracking-widest">Fotografie & Journalismus</p>
        </div>
    </div>

    <!-- LIGHTBOX -->
    <div id="lightbox" onclick="closeLightbox()" class="fixed inset-0 z-50 flex items-center justify-center bg-black/95 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300 cursor-pointer">
        <button onclick="closeLightbox()" class="absolute top-6 right-6 text-white/70 hover:text-white z-50 p-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>
        </button>
        <div class="relative w-full h-full flex items-center justify-center p-4 md:p-12">
            <img id="lightbox-img" src="" alt="Portfolio" onclick="event.stopPropagation()" class="max-h-full max-w-full object-contain shadow-2xl transition-transform duration-300 cursor-default">
            <div class="absolute bottom-6 left-0 right-0 text-center pointer-events-none">
                <p id="lightbox-caption" class="text-white/80 text-sm tracking-widest uppercase font-light font-brand"></p>
            </div>
        </div>
        <button onclick="event.stopPropagation(); changeImage(-1)" class="absolute left-4 top-1/2 -translate-y-1/2 p-4 text-white/50 hover:text-white transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg></button>
        <button onclick="event.stopPropagation(); changeImage(1)" class="absolute right-4 top-1/2 -translate-y-1/2 p-4 text-white/50 hover:text-white transition-colors cursor-pointer"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" /></svg></button>
    </div>

    <!-- 1. HIER LADEN WIR DIE DATEN AUS DER EXTERNEN DATEI -->
    <script src="data.js"></script>

    <script>
        // ==========================================
        // PROGRAMM-LOGIK (Nicht ändern)
        // ==========================================
        let currentCategory = 'all';
        let allImages = []; 
        let currentFilteredImages = [];
        let lightboxIndex = 0;
        let isMobileMenuOpen = false;
        let categories = []; 

        document.getElementById('year').textContent = new Date().getFullYear();

        function generateTitle(src) {
            if (src.includes('?')) return ''; 
            const filename = src.split('/').pop().split('.')[0];
            let title = filename.replace(/[-_]/g, ' ');
            return title.replace(/\w\S*/g, (w) => (w.replace(/^\w/, (c) => c.toUpperCase())));
        }

        function getSafeId(str) {
            return str.toLowerCase().replace(/[^a-z0-9]/g, '');
        }

        // Hilfsfunktion, um Fehler beim Bildladen schön anzuzeigen
        function handleImgError(img, src) {
            const container = img.parentElement;
            container.innerHTML = `
                <div class="w-full h-48 bg-gray-50 border border-red-200 flex flex-col items-center justify-center text-center p-4">
                    <svg class="w-8 h-8 text-red-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>
                    <p class="text-red-900 font-medium text-sm mb-1">Bild nicht gefunden</p>
                    <p class="text-xs text-gray-500 font-mono break-all bg-white px-2 py-1 rounded border border-gray-200 select-all">${src}</p>
                </div>
            `;
            container.removeAttribute('onclick'); 
            container.classList.remove('cursor-pointer');
        }

        function initGallery() {
            // Wir prüfen, ob data.js geladen wurde
            if (typeof window.portfolioData === 'undefined') {
                console.error("data.js konnte nicht geladen werden.");
                const grid = document.getElementById('gallery-grid');
                grid.innerHTML = '<div class="col-span-3 text-center text-red-500 py-10 bg-red-50 border border-red-100 rounded p-6"><strong>Fehler:</strong> Die Datei "data.js" wurde nicht gefunden oder enthält Fehler.<br>Bitte überprüfe die Browser-Konsole (F12) für Details.</div>';
                return;
            }

            const data = window.portfolioData;

            allImages = [];
            categories = [];
            
            data.forEach(item => {
                const catName = item.titel;
                const catId = getSafeId(catName);
                categories.push({ label: catName, id: catId });

                item.bilder.forEach(src => {
                    allImages.push({
                        src: src,
                        category: catId,
                        title: generateTitle(src)
                    });
                });
            });

            renderNav();
            filterImages('all');
        }

        function renderNav() {
            const deskNav = document.getElementById('desktop-nav');
            const mobNav = document.getElementById('mobile-nav-items');
            deskNav.innerHTML = '';
            mobNav.innerHTML = '';

            categories.forEach(cat => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = cat.label;
                btn.onclick = () => filterImages(cat.id);
                btn.className = `text-xs font-medium tracking-[0.15em] uppercase transition-all duration-300 nav-btn-${cat.id}`;
                li.appendChild(btn);
                deskNav.appendChild(li);

                const mobBtn = document.createElement('button');
                mobBtn.textContent = cat.label;
                mobBtn.onclick = () => { filterImages(cat.id); toggleMobileMenu(); };
                mobBtn.className = `text-2xl font-light tracking-widest uppercase transition-transform duration-500 mob-nav-btn-${cat.id}`;
                mobNav.appendChild(mobBtn);
            });
            
            const infoLi = document.createElement('li');
            infoLi.innerHTML = `<button onclick="openInfo()" class="text-xs font-medium tracking-[0.15em] uppercase text-gray-500 hover:text-black transition-colors ml-4">INFO</button>`;
            deskNav.appendChild(infoLi);

            const mobInfoBtn = document.createElement('button');
            mobInfoBtn.textContent = "INFO";
            mobInfoBtn.onclick = () => { toggleMobileMenu(); openInfo(); };
            mobInfoBtn.className = `text-2xl font-light tracking-widest uppercase text-gray-400 mt-4`;
            mobNav.appendChild(mobInfoBtn);
        }

        function updateActiveNavState() {
            categories.forEach(cat => {
                const btns = document.querySelectorAll(`.nav-btn-${cat.id}`);
                btns.forEach(b => {
                    if(currentCategory === cat.id) {
                        b.classList.remove('text-gray-600');
                        b.classList.add('text-black');
                    } else {
                        b.classList.add('text-gray-600', 'hover:text-black');
                        b.classList.remove('text-black');
                    }
                });
                const mobBtns = document.querySelectorAll(`.mob-nav-btn-${cat.id}`);
                mobBtns.forEach(b => {
                     if(currentCategory === cat.id) b.classList.add('border-b', 'border-black', 'pb-1');
                     else b.classList.remove('border-b', 'border-black', 'pb-1');
                });
            });
        }

        function filterImages(category) {
            currentCategory = category;
            updateActiveNavState();
            
            if (category === 'all') {
                currentFilteredImages = allImages;
            } else {
                currentFilteredImages = allImages.filter(img => img.category === category);
            }
            
            const grid = document.getElementById('gallery-grid');
            grid.innerHTML = '';
            
            if (currentFilteredImages.length === 0) {
                document.getElementById('no-results').classList.remove('hidden');
            } else {
                document.getElementById('no-results').classList.add('hidden');
                currentFilteredImages.forEach((img, index) => {
                    const div = document.createElement('div');
                    div.className = 'break-inside-avoid relative group cursor-pointer overflow-hidden mb-4 fade-in';
                    div.onclick = () => openLightbox(index);
                    
                    // Wir escapen single quotes für den onerror handler string
                    const safeSrc = img.src.replace(/'/g, "\\'");
                    
                    div.innerHTML = `
                        <img 
                            src="${img.src}" 
                            alt="${img.title}" 
                            class="w-full h-auto object-cover transition-transform duration-700 ease-in-out group-hover:scale-105 filter brightness-95 hover:brightness-100" 
                            loading="lazy" 
                            onerror="handleImgError(this, '${safeSrc}')"
                        >
                        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"></div>
                    `;
                    grid.appendChild(div);
                });
            }
            if(window.scrollY > 100) window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function openInfo() {
            document.getElementById('info-overlay').classList.remove('opacity-0', 'pointer-events-none');
            document.body.style.overflow = 'hidden';
        }

        function closeInfo() {
            document.getElementById('info-overlay').classList.add('opacity-0', 'pointer-events-none');
            document.body.style.overflow = '';
        }

        function openLightbox(index) {
            lightboxIndex = index;
            updateLightboxContent();
            document.getElementById('lightbox').classList.remove('opacity-0', 'pointer-events-none');
            document.body.style.overflow = 'hidden';
            document.addEventListener('keydown', handleKeyEvents);
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.add('opacity-0', 'pointer-events-none');
            document.body.style.overflow = '';
            document.removeEventListener('keydown', handleKeyEvents);
        }

        function updateLightboxContent() {
            const photo = currentFilteredImages[lightboxIndex];
            if(!photo) return;
            const img = document.getElementById('lightbox-img');
            img.src = photo.src;
            img.onerror = () => { 
                img.src = ''; // Clear broken image
                document.getElementById('lightbox-caption').textContent = 'Bild nicht gefunden: ' + photo.src;
            };
            document.getElementById('lightbox-caption').textContent = photo.title || '';
        }

        function changeImage(direction) {
            lightboxIndex += direction;
            if (lightboxIndex >= currentFilteredImages.length) lightboxIndex = 0;
            if (lightboxIndex < 0) lightboxIndex = currentFilteredImages.length - 1;
            updateLightboxContent();
        }

        function handleKeyEvents(e) {
            if (e.key === 'Escape') {
                closeLightbox();
                closeInfo();
            }
            if (document.getElementById('lightbox').classList.contains('opacity-0')) return;
            if (e.key === 'ArrowRight') changeImage(1);
            if (e.key === 'ArrowLeft') changeImage(-1);
        }

        function toggleMobileMenu() {
            isMobileMenuOpen = !isMobileMenuOpen;
            const menu = document.getElementById('mobile-menu');
            const [b1, b2, b3] = ['burger-1','burger-2','burger-3'].map(id => document.getElementById(id));

            if (isMobileMenuOpen) {
                menu.classList.remove('opacity-0', 'pointer-events-none');
                b1.classList.add('rotate-45', 'translate-y-[7px]');
                b2.classList.add('opacity-0');
                b3.classList.add('-rotate-45', '-translate-y-[7px]');
                document.body.style.overflow = 'hidden';
            } else {
                menu.classList.add('opacity-0', 'pointer-events-none');
                b1.classList.remove('rotate-45', 'translate-y-[7px]');
                b2.classList.remove('opacity-0');
                b3.classList.remove('-rotate-45', '-translate-y-[7px]');
                document.body.style.overflow = '';
            }
        }

        window.addEventListener('load', initGallery);
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>